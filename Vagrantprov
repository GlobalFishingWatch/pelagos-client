 #! /bin/bash

# Ensure apt is up to date
apt-get update

# Install nodejs
if command -v node >/dev/null 2>&1; then
  echo "Nodejs is already installed"
else
  curl -sL https://deb.nodesource.com/setup_0.12 | bash -
  apt-get install -y nodejs
fi

# Install other required utilities to compile and run the project
apt-get install -y unzip openjdk-6-jre

# Install requirements for unit testing
apt-get install -y xvfb chromium-browser
if command -v testem >/dev/null 2>&1; then
  echo "Testem is already installed"
else
  npm install testem -g
fi

# Install requirements for integration testing
if command -v google-chrome >/dev/null 2>&1; then
  echo "Google chrome is already installed"
else
  wget -q -O - "https://dl-ssl.google.com/linux/linux_signing_key.pub" | apt-key add -
  echo 'deb http://dl.google.com/linux/chrome/deb/ stable main' >> /etc/apt/sources.list
  apt-get update
  apt-get install -y google-chrome-stable
fi
apt-get -y install python python-dev python-pip libglapi-mesa libosmesa6 mesa-utils git
pip install -r /vagrant/requirements.txt
pip install chromedriver_installer --install-option="--chromedriver-version=2.10"

